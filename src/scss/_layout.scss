//**********************************************************
// Layout
//----------------------------------------------------------
//
// layout
// grid
// grid-[1...n]
// row
// col
// col-[1...n]
// col-b[1...n]-0
// col-b[1...n]-[1...n]
// span-[1...n]
// order-[1...n]
// order-b[1...n]-[1...n]
// list
// gap
// gap-half
//
//**********************************************************

// Layout
.#{$prefix}layout {
    width:        100%;
    max-width:    $layout_width;
    margin-left:  auto;
    margin-right: auto;

    @include setPropsAdaptive((
            padding-left: $layout_gap,
            padding-right: $layout_gap,
    ));
}

// Grid
.#{$prefix}grid {
    display:        grid;
    grid-auto-rows: minmax($grid_cell_height, auto);
}

%grid {
    @extend .#{$prefix}grid;
    @extend .#{$prefix}gap;
    grid-auto-flow: row;
}

.#{$prefix}gap {
    @include setPropsAdaptive((
            grid-gap: $grid_gap
    ));

    &-half {
        @include setPropsAdaptive((
                grid-gap: $grid_gap_half
        ));
    }

    &-0 {
        grid-gap: 0;
    }
}

.#{$prefix}row {
    @extend .#{$prefix}grid;
    grid-template-columns: repeat(auto-fit, minmax($grid_cell_height, auto));
    grid-auto-flow:        column;
}

.#{$prefix}col {
    @extend .#{$prefix}grid;
    grid-template-rows: repeat(auto-fit, minmax($grid_cell_height, auto));
    grid-auto-flow:     dense;
}

.#{$prefix}bar {
    @extend .#{$prefix}row;
    // TODO: bar
}

.#{$prefix}list {
    @extend .#{$prefix}col;
    // TODO: list
}

[class*="#{$prefix}col-"] {
    width:     auto;
    max-width: none;
}

@for $i from 1 through $grid_column {
    .#{$prefix}grid-#{$i} {
        grid-template-columns: repeat($i, 1fr);
        @extend %grid;
    }

    .#{$prefix}col-#{$i},
    .#{$prefix}grid-#{$i},
    .#{$prefix}grid-#{$i} > .#{$prefix}row {
        grid-column-end: span $i;
    }

    .#{$prefix}span-#{$i} {
        grid-column-start: $i;
    }

    .#{$prefix}order-#{$i} {
        order: $i;
    }
}

// Breakpoints
@for $i from $grid_column to 0 {
    @media only screen and (max-width: getBreakpoint($i)) {

        // Shrink
        @if $i < $grid_column {
            $k: $i + 1;

            .#{$prefix}shrink {
                &,
                > %grid-#{$k} {
                    grid-template-columns: repeat($i, 1fr);
                }

                > %col-#{$k},
                > .#{$prefix}grid-#{$k} > .#{$prefix}col,
                > .#{$prefix}grid-#{$k} > .#{$prefix}row {
                    grid-column-end: span $i;
                }
            }

            @for $j from $k through $grid_column {
                .#{$prefix}col-#{$j},
                .#{$prefix}grid-#{$j} {
                    @extend %col-#{$k};
                    @extend %grid-#{$k};
                }
            }
        }

        // Actions
        [class*="#{$prefix}col-b#{$i}-"] {
            display: initial;
        }

        .#{$prefix}col-b#{$i}-0 {
            display: none;
        }

        [class*="#{$prefix}gap-b#{$i}-"] {
            grid-gap: initial;
        }

        .#{$prefix}gap-b#{$i}-0 {
            grid-gap: 0;
        }

        @for $j from 1 through $grid_column {
            .#{$prefix}col-b#{$i}-#{$j} {
                grid-column-end: span $j;
            }

            .#{$prefix}order-b#{$i}-#{$j} {
                order: $j;
            }
        }
    }
}
