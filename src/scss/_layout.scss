//**********************************************************
// Layout
//----------------------------------------------------------
//
//**********************************************************
//@import "mixins/bar";
//@import "mixins/list";

// Grid
//----------------------------------------------------------
// .grid
//**********************************************************
%#{$prefix}grid {
    @extend %#{$prefix}display-grid;
    grid-auto-rows: minmax($cell_width, auto);
}

.#{$prefix}grid {
    @extend %#{$prefix}grid;
    grid-auto-flow: row;
    //align-items:    baseline;

    @if $is_grid_gap {
        @extend %#{$prefix}grid-gap;
    }
}

%#{$prefix}grid-child-fit {
    @extend %#{$prefix}child-fit;
    @extend %#{$prefix}reset-width;
}

// Gap
//----------------------------------------------------------
// .gap
// .gap-half
// .gap-0
//**********************************************************
.#{$prefix}gap {
    @extend %#{$prefix}grid-gap;
}

// Row
//----------------------------------------------------------
// .row
//**********************************************************
.#{$prefix}row {
    @extend %#{$prefix}grid;
    grid-template-columns: repeat(auto-fit, minmax($cell_width, auto));
    grid-auto-flow:        column;
    //@extend %#{$prefix}grid-child-fit;
}

// Bar
//----------------------------------------------------------
// .bar
//**********************************************************
.#{$prefix}bar {
    @extend .#{$prefix}row;
}

// Column
//----------------------------------------------------------
// .col
// .col-[1...n]
// .col-b[1...n]-[1...n]
//**********************************************************
.#{$prefix}col {
    @extend %#{$prefix}grid;
    grid-template-rows: repeat(auto-fit, minmax($cell_width, auto));
    grid-auto-flow:     dense;
    //@extend %#{$prefix}grid-child-fit;
}

// List
//----------------------------------------------------------
// .list
//**********************************************************
.#{$prefix}list {
    @extend .#{$prefix}col;
}

// Shrink
//----------------------------------------------------------
// .shrink
//**********************************************************
//@if not $is_grid_gap {
//    .#{$prefix}shrink {
//        grid-template-columns: repeat(auto-fit, minmax(GetMinShrinkWidth(), 1fr));
//    }
//}

// Container
//----------------------------------------------------------
// .container
//**********************************************************
.#{$prefix}container {
    width:        100%;
    max-width:    $layout_width;
    margin-left:  auto;
    margin-right: auto;
    @extend %#{$prefix}padding-left, %#{$prefix}padding-right;
}

// Checkpoints
//----------------------------------------------------------
// .grid-[1...n]
// .tile-[1...n]
// .col-[1...n]
// .span-[1...n]
// .order-[1...n]
//**********************************************************
@for $i from 1 through $grid_column {
    .#{$prefix}grid-#{$i} {
        @extend .#{$prefix}grid;
        grid-template-columns: repeat($i, 1fr);
    }

    //.#{$prefix}tile-#{$i} {
    //    @extend %#{$prefix}grid;
    //}

    .#{$prefix}col-#{$i},
    .#{$prefix}grid-#{$i},
    .#{$prefix}grid-#{$i} > %#{$prefix}grid-child-fit {
            grid-column-end: span $i;
    }

    .#{$prefix}span-#{$i} {
        grid-column-start: $i;
    }

    .#{$prefix}order-#{$i} {
        order: $i;
    }
    //@warn GetMinTileWidth($i);
    //@if not $is_grid_gap {
    //.#{$prefix}tile-#{$i} {
    //    grid-template-columns: repeat(auto-fit, minmax(GetMinTileWidth($i), 1fr)) !important;
    //}
    //}
}

// Breakpoints
//----------------------------------------------------------
// .shrink
// .col-b[1...n]-[1...n]
// .span-b[1...n]-[1...n]
// .order-b[1...n]-[1...n]
//**********************************************************
@for $i from $grid_column to 0 {
    @media only screen and (max-width: GetBreakpoint($i)) {
        @include pasteBuffer($i);

        @for $j from 1 through $grid_column {
            .#{$prefix}col-b#{$i}-#{$j} {
                grid-template-columns: repeat($j, 1fr);

                &, > %#{$prefix}grid-child-fit {
                    grid-column-end: span $j;
                }
            }

            .#{$prefix}span-b#{$i}-#{$j} {
                grid-column-start: $j;
            }

            .#{$prefix}order-b#{$i}-#{$j} {
                order: $j;
            }
        }

        // Shrink
        @if $i < $grid_column {
            $k: $i + 1;

            .#{$prefix}shrink {
                &%#{$prefix}grid-shrink-#{$k} {
                    grid-template-columns: repeat($i, 1fr);
                }

                > %#{$prefix}col-shrink-#{$k},
                > .#{$prefix}grid-#{$k} > %#{$prefix}grid-child-fit {
                    grid-column-end: span $i;
                }
            }

            @for $j from $k through $grid_column {
                .#{$prefix}grid-#{$j} {
                    @extend %#{$prefix}grid-shrink-#{$k};
                }

                .#{$prefix}col-#{$j},
                .#{$prefix}grid-#{$j} {
                    @extend %#{$prefix}col-shrink-#{$k};
                }
            }
        }
    }
}
